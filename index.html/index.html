#include <WiFi.h>
#include <HTTPClient.h>
#include <DHT.h>

#define DHTPIN 4         // DHT sensörünün bağlı olduğu pin (GPIO 4)
#define DHTTYPE DHT11    // DHT tipi (DHT11 veya DHT22)

const char* ssid = "WiFi_ADI"; 
const char* password = "WiFi_ŞİFRESİ";
const char* server = "http://seninsite.com/data.php"; // Web sitesi URL'si

DHT dht(DHTPIN, DHTTYPE);

void setup() {
  Serial.begin(115200);
  dht.begin();
  
  WiFi.begin(ssid, password);
  Serial.print("Wi-Fi'ye bağlanıyor");
  while (WiFi.status() != WL_CONNECTED) {
    delay(1000);
    Serial.print(".");
  }
  Serial.println("\nWi-Fi bağlandı!");
}

void loop() {
  float temperature = dht.readTemperature();
  
  if (!isnan(temperature)) {
    Serial.print("Sıcaklık: ");
    Serial.println(temperature);

    if (WiFi.status() == WL_CONNECTED) {
      HTTPClient http;
      http.begin(server);

      http.addHeader("Content-Type", "application/x-www-form-urlencoded");

      String postData = "temp=" + String(temperature);
      int httpResponseCode = http.POST(postData);

      if (httpResponseCode > 0) {
        String response = http.getString();
        Serial.println("Sunucu Yanıtı: " + response);
      } else {
        Serial.print("Bağlantı hatası: ");
        Serial.println(httpResponseCode);
      }

      http.end();
    }
  } else {
    Serial.println("Sensör verisi okunamıyor!");
  }
  
  delay(5000); // 5 saniyede bir veri gönder
}
